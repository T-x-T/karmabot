version: '3.1'

services:
  node:
    image: registry.gitlab.com/t-x-t/karmabot:master
    restart: always
    volumes:
      - "/opt/karmabot/config.prod.json:/srv/karmabot/config.prod.json"
    links:
      - redis
    networks:
      - nginx
  redis:
    image: redis
    restart: always
    volumes:
      - "/opt/karmabot/redis.conf:/usr/local/etc/redis/redis.conf"
      - "/redisdata:/data"
    command: [ "redis-server", "/usr/local/etc/redis/redis.conf" ]

networks:
  nginx:
    external: true